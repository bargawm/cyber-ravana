<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cyber Ravana | Full Security Suite</title>
    <style>
        body { font-family: 'Courier New', monospace; background: #000; color: #00ff41; text-align: center; padding: 20px; }
        .tool-box { border: 1px solid #00ff41; padding: 20px; margin: 20px auto; max-width: 800px; border-radius: 8px; background: #161b22; box-shadow: 0 0 15px rgba(0,255,65,0.2); }
        input, textarea, button { margin: 10px; padding: 10px; border-radius: 4px; border: 1px solid #00ff41; background: #0d1117; color: #00ff41; width: 85%; }
        button { background: #00ff41; color: #000; font-weight: bold; cursor: pointer; width: auto; transition: 0.3s; }
        button:hover { background: #00cc33; }
        .tab-button { background: #333; color: #00ff41; border: 1px solid #00ff41; margin: 5px; }
        .tab-button.active { background: #00ff41; color: #000; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .status-pass { color: #00fa41; font-weight: bold; }
        .status-fail { color: #ff4141; font-weight: bold; }
        .log-box { text-align: left; background: #222; padding: 10px; font-size: 0.9em; margin-top: 10px; border: 1px solid #333; max-height: 200px; overflow-y: auto; }
        canvas { display: none; }
    </style>
</head>
<body>
    <h1>üõ°Ô∏è CYBER RAVANA: MULTI-TOOL SUITE</h1>
    
    <div id="tabs">
        <button class="tab-button active" onclick="showTab('stego')">Steganography</button>
        <button class="tab-button" onclick="showTab('crypto')">Cryptography</button>
        <button class="tab-button" onclick="showTab('scan')">Scanning</button>
        <button class="tab-button" onclick="showTab('pentest')">Pen Testing</button>
        <button class="tab-button" onclick="showTab('ethical')">Ethical Hacking</button>
        <button class="tab-button" onclick="showTab('malware')">Malware Analysis</button>
        <button class="tab-button" onclick="showTab('forensics')">Forensics</button>
        <button class="tab-button" onclick="showTab('osint')">OSINT</button>
        <button class="tab-button" onclick="showTab('network')">Network Tools</button>
        <button class="tab-button" onclick="showTab('websec')">Web Security</button>
        <button class="tab-button" onclick="showTab('mobile')">Mobile Security</button>
        <button class="tab-button" onclick="showTab('cloud')">Cloud Security</button>
        <button class="tab-button" onclick="showTab('threat')">Threat Intel</button>
        <button class="tab-button" onclick="showTab('incident')">Incident Response</button>
        <button class="tab-button" onclick="showTab('ids')">IDS/IPS</button>
        <button class="tab-button" onclick="showTab('firewall')">Firewall</button>
        <button class="tab-button" onclick="showTab('reverse')">Reverse Eng</button>
        <button class="tab-button" onclick="showTab('password')">Password Tools</button>
        <button class="tab-button" onclick="showTab('social')">Social Eng</button>
        <button class="tab-button" onclick="showTab('ransom')">Ransomware</button>
        <button class="tab-button" onclick="showTab('zero')">Zero-Day</button>
        <button class="tab-button" onclick="showTab('priv')">Privilege</button>
        <button class="tab-button" onclick="showTab('siem')">SIEM</button>
        <button class="tab-button" onclick="showTab('log')">Log Monitor</button>
        <button class="tab-button" onclick="showTab('honey')">Honeypots</button>
        <button class="tab-button" onclick="showTab('hunt')">Threat Hunting</button>
    </div>
    
    <div id="stego" class="tab-content active">
        <div class="tool-box">
            <h3>üïµÔ∏è ENCRYPTED STEGANOGRAPHY</h3>
            <input type="file" id="stegoFile" accept="image/*">
            <input type="password" id="stegoPass" placeholder="Secret Key">
            <textarea id="stegoMsg" placeholder="Message to hide..."></textarea>
            <button onclick="runStego(true)">HIDE MESSAGE</button>
            <button onclick="runStego(false)">DECODE IMAGE</button>
            <p id="stegoResult"></p>
            <img id="encodedImage" style="display:none; max-width:100%;">
        </div>
    </div>
    
    <div id="crypto" class="tab-content">
        <div class="tool-box">
            <h3>üîê CRYPTOGRAPHY</h3>
            <textarea id="cryptoText" placeholder="Text to encrypt/decrypt"></textarea>
            <input type="password" id="cryptoKey" placeholder="Key">
            <button onclick="encryptText()">ENCRYPT</button>
            <button onclick="decryptText()">DECRYPT</button>
            <p id="cryptoResult"></p>
        </div>
    </div>
    
    <div id="scan" class="tab-content">
        <div class="tool-box">
            <h3>üîç VULNERABILITY SCANNING</h3>
            <input type="text" id="scanTarget" placeholder="IP/URL to scan">
            <button onclick="runVulnScan()">SCAN</button>
            <div id="scanResults" class="log-box" style="display:none;"></div>
        </div>
        <div class="tool-box">
            <h3>üåê WEBSITE SAFETY SCANNER</h3>
            <input type="text" id="urlInput" placeholder="Enter URL">
            <button onclick="scanURL()">RUN SECURITY SCAN</button>
            <div id="urlResults" class="log-box" style="display:none;"></div>
        </div>
    </div>
    
    <div id="pentest" class="tab-content">
        <div class="tool-box">
            <h3>üõ†Ô∏è PENETRATION TESTING</h3>
            <input type="text" id="pentestTarget" placeholder="Target IP/URL">
            <button onclick="runPentest()">RUN BASIC TESTS</button>
            <div id="pentestResults" class="log-box" style="display:none;"></div>
        </div>
    </div>
    
    <div id="ethical" class="tab-content">
        <div class="tool-box">
            <h3>üõ°Ô∏è PASSWORD STRENGTH CHECKER</h3>
            <input type="password" id="passwordInput" placeholder="Enter password">
            <button onclick="checkPasswordStrength()">CHECK STRENGTH</button>
            <p id="passwordResult"></p>
        </div>
    </div>
    
    <div id="malware" class="tab-content">
        <div class="tool-box">
            <h3>ü¶† MALWARE ANALYSIS</h3>
            <input type="file" id="malwareFile">
            <button onclick="analyzeMalware()">ANALYZE FILE</button>
            <div id="malwareResults" class="log-box" style="display:none;"></div>
        </div>
    </div>
    
    <div id="forensics" class="tab-content">
        <div class="tool-box">
            <h3>üîç DIGITAL FORENSICS</h3>
            <input type="file" id="forensicsFile">
            <button onclick="analyzeForensics()">EXTRACT METADATA</button>
            <div id="forensicsResults" class="log-box" style="display:none;"></div>
        </div>
    </div>
    
    <script>
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }
        
        async function runStego(encode) {
            const file = document.getElementById('stegoFile').files[0];
            const pass = document.getElementById('stegoPass').value;
            const msg = document.getElementById('stegoMsg').value;
            if (!file || !pass) return alert("File and Key required!");
            if (encode && !msg) return alert("Message required for encoding!");
            
            const formData = new FormData();
            formData.append('file', file);
            formData.append('key', pass);
            if (encode) formData.append('message', msg);
            
            const url = encode ? '/api/steganography/encode' : '/api/steganography/decode';
            const response = await fetch(url, { method: 'POST', body: formData });
            const result = await response.json();
            
            if (result.success) {
                if (encode) {
                    document.getElementById('encodedImage').src = 'data:image/png;base64,' + result.image;
                    document.getElementById('encodedImage').style.display = 'block';
                    document.getElementById('stegoResult').innerText = 'Image encoded successfully!';
                } else {
                    document.getElementById('stegoResult').innerText = 'Decoded: ' + result.message;
                }
            } else {
                document.getElementById('stegoResult').innerText = 'Error: ' + result.error;
            }
        }
        
        async function scanURL() {
            const url = document.getElementById('urlInput').value;
            if (!url) return alert("Enter a URL!");
            
            const response = await fetch('/api/url_scan', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ url })
            });
            const result = await response.json();
            
            document.getElementById('urlResults').style.display = 'block';
            document.getElementById('urlResults').innerHTML = `
                <p>SSL Check: <span class="${result.ssl === 'SECURE' ? 'status-pass' : 'status-fail'}">${result.ssl}</span></p>
                <p>Keywords: <span class="${result.keywords === 'CLEAN' ? 'status-pass' : 'status-fail'}">${result.keywords}</span></p>
                <p>Risk Score: <span class="${result.risk_score.includes('HIGH') ? 'status-fail' : 'status-pass'}">${result.risk_score}</span></p>
            `;
        }
        
        async function encryptText() {
            const text = document.getElementById('cryptoText').value;
            const key = document.getElementById('cryptoKey').value;
            if (!text || !key) return alert("Text and key required!");
            
            const response = await fetch('/api/cryptography/encrypt', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, key })
            });
            const result = await response.json();
            document.getElementById('cryptoResult').innerText = result.result || result.error;
        }
        
        async function decryptText() {
            const text = document.getElementById('cryptoText').value;
            const key = document.getElementById('cryptoKey').value;
            if (!text || !key) return alert("Text and key required!");
            
            const response = await fetch('/api/cryptography/decrypt', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ text, key })
            });
            const result = await response.json();
            document.getElementById('cryptoResult').innerText = result.result || result.error;
        }
        
        async function runVulnScan() {
            const target = document.getElementById('scanTarget').value;
            if (!target) return alert("Target required!");
            
            document.getElementById('scanResults').style.display = 'block';
            document.getElementById('scanResults').innerHTML = 'Scanning...';
            
            const response = await fetch('/api/vulnerability/scan', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ target })
            });
            const result = await response.json();
            
            if (result.results) {
                document.getElementById('scanResults').innerHTML = result.results.join('<br>');
            } else {
                document.getElementById('scanResults').innerHTML = result.error;
            }
        }
        
        async function checkPasswordStrength() {
            const password = document.getElementById('passwordInput').value;
            if (!password) return alert("Enter password!");
            
            const response = await fetch('/api/password/strength', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ password })
            });
            const result = await response.json();
            document.getElementById('passwordResult').innerText = result.strength || result.error;
        }
        
        async function analyzeMalware() {
            const file = document.getElementById('malwareFile').files[0];
            if (!file) return alert("Select file!");
            
            const formData = new FormData();
            formData.append('file', file);
            
            const response = await fetch('/api/malware/analyze', {
                method: 'POST',
                body: formData
            });
            const result = await response.json();
            
            document.getElementById('malwareResults').style.display = 'block';
            document.getElementById('malwareResults').innerHTML = `
                <p>Hash: ${result.hash}</p>
                <p>Result: <span class="${result.result === 'MALICIOUS' ? 'status-fail' : 'status-pass'}">${result.result}</span></p>
            `;
        }
        
        async function analyzeForensics() {
            const file = document.getElementById('forensicsFile').files[0];
            if (!file) return alert("Select file!");
            
            const formData = new FormData();
            formData.append('file', file);
            
            const response = await fetch('/api/forensics/metadata', {
                method: 'POST',
                body: formData
            });
            const result = await response.json();
            
            document.getElementById('forensicsResults').style.display = 'block';
            document.getElementById('forensicsResults').innerHTML = `
                <p>Filename: ${result.filename}</p>
                <p>Size: ${result.size} bytes</p>
                <p>Type: ${result.type}</p>
                ${result.exif ? `<p>EXIF: ${result.exif}</p>` : ''}
            `;
        }
    </script>
</body>
</html>
